@(firstName: String, secondName:String, firstListWeights: List[Integer], secondListWeights:List[Integer], firstListSpeeds: List[Integer], secondListSpeeds: List[Integer])

<style>
	html {
		font-family: sans-serif;
	}
	
	#wrapper {
		border: 1px solid black;
		height: 800px;
		width: 800px;
		margin: 0 auto;
	}

	.half-window {
		padding-top: 5px;
		height: 399px;
		width: 600px;
		margin-left:100px;
		position:relative;
	}
	
	.half-window h1 {
		margin-top: 30px;
		margin-bottom: -30px;
	}
	
	.separator {
		height: 1px;
		width: 800px;
		background-color:#000;
	}
	
	.character {
		margin-top: 65px;
		width: 150px;
		height: 200px;
		z-index:100;
	}
	
	.message {
		margin-left: 160px;
		padding-top: 30px;
	}
	
	#first .character {
		background-color: #ff0000;
	}
	
	#second .character {
		background-color: #00ff00;
	}
	
	.distance-marker {
		border-left: 5px solid gray;
		height: 10px;
		width: 20px;
		padding-top: 100px;
		padding-left: 15px;
		position: absolute;
		top: 250px;
		z-index:-999;
	}
</style>

@main("410 Project") {
	<div id="wrapper">
		<div id="first" class="half-window">
	    	<h1>@firstName</h1>
	    	<div class="character">
	    		<div class="sprite"></div>
	    		<div class="message">Message</div>
	    	</div>
	    	<div class="markers"></div>
	    </div>
	    
	    <div class="separator"></div>
	    
	    <div id="second" class="half-window">
	    	<h1>@secondName</h1>
	    	<div class="character">
		    	<div class="sprite"></div>
		    	<div class="message">Message</div>
	    	</div>
	    	<div class="markers"></div>
	    </div>
	</div>
}

<script>
	// referencing http://www.paulirish.com/2011/requestanimationframe-for-smart-animating/
	window.requestAnimFrame = (function(){
	  return  window.requestAnimationFrame       ||
	          window.webkitRequestAnimationFrame ||
	          window.mozRequestAnimationFrame    ||
	          function( callback ){
	            window.setTimeout(callback, 1000 / 60);
	          };
	})();

	$(document).ready(function() {
		updateMarkers();
		loop();
	});
	
	const scaleFactor = 40;
	const meterIncrement = 10;
	const framesPerWeek = 100;
	
	var firstPosition = 0;
	var secondPosition = 0;
	
	var firstListWeights = @Html(firstListWeights.toString());
	var secondListWeights = @Html(secondListWeights.toString());
	
	var firstListSpeeds = @Html(firstListSpeeds.toString());
	var secondListSpeeds = @Html(secondListSpeeds.toString());
	
	console.log("ListWeights length: " + firstListWeights.length);
	
	var frameCount = 0;
	function loop() {
		if ((frameCount / framesPerWeek) < firstListWeights.length) {
			console.log("Frame Count: " + frameCount);
		
			requestAnimFrame(loop);
			updateFirstRepo(frameCount);
			updateSecondRepo(frameCount);
			updateMarkers();
			frameCount++;
		}
	}
	
	function updateMarkers() {
		updateFirstRepoMarkers();
		updateSecondRepoMarkers();
	}

	function updateFirstRepoMarkers() {
		$markers = $('#first .markers');
		$markers.html('');
		for(var i = firstPosition - 100; i < firstPosition + 700; i+=1) {
			if(i % (scaleFactor * meterIncrement) == 0) {
				$markers.append('<div class="distance-marker" style="left: ' + i + '" >' + i/scaleFactor + 'm</div>');
			}
		}
	}
	
	function updateSecondRepoMarkers() {
		$markers = $('#second .markers');
		$markers.html('');
		console.log("new position: " + secondPosition);
		for(var i = secondPosition - 100; i < secondPosition + 700; i+=1) { 
			if(i % (scaleFactor * meterIncrement) == 0) {
				$markers.append('<div class="distance-marker" style="left: ' + i + '" >' + i/scaleFactor + 'm</div>');
			}
		}
	}
	
	function updateFirstRepo( frameNum ) { 
		updateHalfWindow($('#first'), firstListWeights, firstListSpeeds, frameNum, firstPosition);
	} 
	
	function updateSecondRepo( frameNum ) { 
		updateHalfWindow($('#second'), secondListWeights, secondListSpeeds, frameNum, secondPosition);
	}
	
	function updateHalfWindow( $window, weights, speeds, frameNum, positionVar ) {
		if (window.frameCount % framesPerWeek == 0) {
			// change weight appearance
		}
		
		currIndex = Math.floor(window.frameCount / framesPerWeek);
		
		if ($window.attr('id') == "first") {
			firstPosition += speeds[currIndex] * scaleFactor;
		} else if ($window.attr('id') == "second"){
			secondPosition += speeds[currIndex] * scaleFactor;
		}
	}
</script>